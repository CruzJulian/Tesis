---
title: "Fundamentos"
author: "Julian Cruz"
output: 
  pdf_document:
    keep_tex: true
    toc: false
    number_sections: true
---

# Desarrollo

## Nube de puntos

El objeto de estudio se denomina nube de puntos. En el argot estadístico una nube de puntos es un concepto intuitivo, que corresponde de alguna manera a una colección finita en un espacio euclidiano. Muchas veces los valores preesentan una estructura de pesos muestrales o factores de expansión asociados. Estos conceptos se formalizan a continuación.

Sea $(\Omega, \mathcal{A})$ un espacio medible cualquera fijo. Las siguientes son directrices de notación y definiciones iniciales:

 - Un conjunto de medidas de probabilidad sobre $(\Omega, \mathcal{A})$ se denomina familia y se nota $\mathcal{P}$. Si es posible indexarlo mediante un espacio de dimensión finita se denomina familia paramétrica, caso contrario se denomina familia no paramétrica. El conjunto de todas las medidas de probabilidad sobre $(\Omega, \mathcal{A})$ se nota $\mathbb{P}$. Dada una medida $\lambda$ sobre $(\Omega, \mathcal{A})$ se nota $\mathbb{P}_\lambda$ el conjunto de todas las medidas de probabilidad sobre $(\Omega, \mathcal{A})$ absolutamente contínuas con respecto a $\lambda$.
 - El conjunto que indexa una familia $\mathcal{P}$ es su espacio de parámetros. Una familia paramétrica tiene un espacio de parámetros de dimensión finita; una familia no paramétrica, necesariamente infinita. Toda familia se puede indexar a sí misma, en este sentido una medida de probabilidad puede ser un parámetro de si misma.
 - Dado $n$ un número natural, $1:n$ es el intervalo de núeros naturales entre 1 y $n$ inclusive.
 - El conjunto de partes, $\wp(1:n)$, se nota en adelante $\wp_n$.
 - Se nota $\textbf{P}_n$ al conjunto de todas las medidas de probabilidad sobre $(1:n, \wp_n)$. Sea $p$ un elemento de $\textbf{P}_n$.
 - Una función $s$ del espacio de probabilidad $(1:n,\wp_n, p)$ en el espacio medible, $(\Omega, \mathcal{A})$ se denomina nube de puntos. Evidentemente toda nube de puntos es función simple y en consecuencia es medible.^[Revisar en Shao]
 - Dada una nube de puntos $s$, siendo función, tiene dominio $Dom(s)$, rango $Ran(s)$, y en virtud de ser medible tiene una medida asociada $P_s$ sobre $(\Omega, \mathcal{A})$.
 - Dada una nube de puntos $s$ su tamaño es el máximo de su dominio: $n_s := \max(Dom(s))$.
 - El conjunto de todas las nubes de puntos de tamaño $n$ se denomina $s_n$. Esto es $s_n := \{ s: (1:n, \wp_n, p) \rightarrow (\Omega, \mathcal{A}) \mid p \in \textbf{P}_n \land n \in \mathbb{N} \}$
 - El conjunto de todas las nubes de puntos posibles se nota por $\textbf{S}$. En otras palabras: $\textbf{S} = \bigcup_{i=1}^\infty s_n$.

De esta manera queda formalizado por completo el concepto de nubes de puntos. Como se ve, una nube de puntos $s$ tiene tamaño y probabilidades asociadas. En el uso cotidiano se suelen usar medidas de probabilidad $p_n$ uniformes, dando a cada punto un peso de $\frac{1}{n}$.

### Teoremas, proposiciones, etc

Sea $(\Omega, \mathcal{A})$ un espacio medible cualquera fijo y $s$ una nube de puntos cualquiera sobre $(\Omega, \mathcal{A})$. Los siguientes enunciados se tienen en consecuencia de las definiciones anteriores.

 - Si $\Omega$ está contenido en $\mathbb{R}^k$, $s$ es variable aleatoria.
 - En este caso el valor esperado de $s$ es $E(s) = \sum_{i=1}^{n_s} p(\{i\})s(i)$. Que en algunos ámbitos se denomina media muestral.^[Cuestionar]
 - Asímismo, la varianza de $s$ es $Var(s) = \sum_{i=1}^{n_s} p(\{i\})(s(i) - E(s))^2$. Que en algunos ámbitos se denomina varianza poblacional.^[Cuestionar]

### Ejemplo

Una medida de probabilidad $p$ sobre $(1:n, \wp_n)$ queda definida completamente a partir de los valores $p(\{i\})$. Así, es posible especificar una nube de puntos listando los valores de $s(i)$ y de $p(\{i\})$. Por ejemplo para $(\mathbb{N}, \wp(\mathbb{N}))$ espacio medible, $s = (1, 2, 3, 5)$, $p = (0.3, 0.2, 0.2, 0.3)$ es una nube de puntos.

### Ejemplo bonito

Sea $\Omega = \mathbb{R}^+\times\mathbb{R}^+\times\mathbb{R}^+\times\mathbb{R}^+\times \{ `r paste(unique(iris$Species), collapse = ", ")` \}$ y $\mathcal{A} = \mathcal{B}\times\mathcal{B}\times\mathcal{B}\times\mathcal{B}\times\wp$. Iris es una nube de puntos $s$ de $(1:150, \wp_{150}, P_u)$ en $(\Omega, \mathcal{A})$, donde $P_u$ es la medida de probabilidad uniforme.

## Cielo aleatorio, cielo de puntos, cielito lindo^[No me vaya a dejar esto así]

Algunas propiedades y ejemplos

$\textbf{S}$ es un conjunto muy áspero. Es posible realizar algunas restricciones interesantes.

 - Sea una medida $\mu$ sobre el espacio medible $(\mathbb{N}, \wp(\mathbb{N}))$, sea $p_n$ la medida de probabilidad generada por $\mu$ sobre $(1:n, \wp_n)$, es decir: $p_n(A) = \frac{\mu(A)}{\mu(1:n)}$ así $\textbf{S} \mid_\mu$ es el subconjunto de $\textbf{S}$ cuyos elementos $s$ tienen como dominio $(1:n, \wp_n,p _n)$.
 
 - Sea $n$ un entero positivo fijo, $\textbf{S} \mid_n$ es el subconjunto de $\textbf{S}$ cuyos elementos $s$ tienen tamaño $n$.

 - $\textbf{S} \mid_{\mu,n}$ es la restricción de $\textbf{S}$ cuyos elementos $s$ tienen tamaño $n$ y probabilidad $p_n(\{i\}) = \frac{\mu(\{i\})}{\mu(1:n)}$.

Teorema y definición

Sean $(\Omega, \mathcal{A}, P, \lambda)$, con $P$ en una familia $\mathbb{P}_\lambda$, un espacio de medida cualquera fijo y $\textbf{S}$ definido según lo mostrado previamente, $f = \frac{dP}{d\lambda}$ la derivada de radon-Nikodim^[este nombre está bien?] de $P$ con respeto a $\lambda$. Sea

\begin{align}
f^*: &\textbf{S} \longrightarrow \mathbb{R}\\
& s \mapsto f^*(s) = \prod\limits_{i=1}^{n_s} f(s(i))
\end{align}

Entonces, a función de conjuntos $P^*$ definida como

\begin{align}
P^* &:  \wp(\textbf{S}) \longrightarrow [0,1]\\
& S \subseteq \textbf{S} \mapsto P^*(S) := \int I_S f^* d\lambda
\end{align}

Es una función de medida. En particular el espacio de medida $(\textbf{S}, \mathcal{P}(\textbf{S}), \lambda^*)$ se denomina el cielo aleatorio de $(\Omega, \mathcal{A}, \lambda)$.

### teorema otro^[arreglarlo]

Dados $n$ y $\mu$, $\textbf{S} \mid_{\mu,n}$ es un subconjunto de $\textbf{S}$. Su medida es 1.

## Teorema de grandes números^[Confirmar]

Sean $(\mathbb{R}^k, \mathcal{B}^k, \lambda)$ un espacio de medida cualquera fijo, $(\textbf{S}, \wp(\textbf{S}), P^*)$ su cielo de puntos, $f: (\mathbb{R}^k, \mathcal{B}^k, \lambda) \leftarrow (\mathbb{R}, \mathcal{B})$ una función medible. Entonces $e_f$ el valor esperado visto como opreador sobre el cielo de puntos.

\begin{align}
e_f &:  (\textbf{S}, \wp(\textbf{S}), P^*) \longrightarrow (\mathbb{R}^k, \mathcal{B}^k, P, \lambda)\\
& s \in \mathbb{S} \mapsto e_f(s) := E(f\circ s)
\end{align}

Con $E(s) = \sum_{i=1}^{n_s} p(\{i\})f(s(i))$ como ya se vio.

tiene las propiedades:

 - $e$ está bien definido.
 - $e$ es una variable aleatoria.
 - Su valor esperado $E(e) = \int e dP^*$ es igual a $E(f) = \int f d\lambda$ ???.


# especulación
 
Se define la función $\mathfrak{P}$ de $\textbf{S}$ en $\mathbb{P}$ como sigue:

\begin{align}
\mathfrak{P}: & \textbf{S} \longrightarrow \mathbb{P}  \\
& s \mapsto \mathfrak{P}(s) := P_s
\end{align}

donde

\begin{align}
P_s: & \mathcal{A} \longrightarrow \mathbb{R} \\
& A \mapsto P_s(A) := p(s^{-1}(A))
\end{align}

La función $\mathfrak{P}$ asigna a cada $s \in \textbf{S}$ su medida de probabilidad asociada. Esto es crucial para poder definir el conjunto $\mathbb{S} := \textbf{S}/\mathfrak{P}$. 

Se dice que dos nubes de puntos $s_1$ y $s_2$ son equivalentes si son iguales en $\mathbb{S}$ y se nota $s_1 \equiv s_2$.

 - Dos nubes de puntos equivalentes $s_1 \equiv s_2$ tienen el mismo rango, el mismo valor esperado y la misma varianza. Esto no se cumple para tamaño.
 - $\mathbb{S}$ es inmune a permutaciones. Dada una permutación $j$ tal que $s_1(i) = s_2(j)$ entonces $s_1 \equiv s_2$.

### Ejemplo:

Las siguientes nubes de puntos son equivalentes:

- $(1, 2, 2, 3) (0.3, 0.2, 0.2, 0.3)$

- $(1, 3, 2, 2) (0.3, 0.3, 0.2, 0.2)$

- $(1, 2, 3) (0.3, 0.4, 0.3)$

- $(1, 2, 3, 1) (0.2, 0.4, 0.3, 0.1)$


# hasta aquí por hoy



Sean $n$ un número natural, $1:n$ el intervalo de los naturales entre 1 y $n$ inclusive, $(1:n, \mathcal{P}, \mu)$, $(\Omega, \mathcal{A}, \lambda)$ un espacio de medida, $S$ una función medible de $1:n$ en $\Omega$. $S$ es una nube de puntos. 

Sea $\lambda_S$ la medida de probabilidad sobre $\Omega$ generada por $S$.




Así, la definición formal de nube de puntos habla tanto de los puntos: $S$; como de sus pesos: $a$. La construción de $S$ como elemento de $\Omega^n$ permite usar valores repetidos: $(1, 2, 2, 3)$; sin embargo $(1, 2, 3) \neq (3, 2, 1)$, es decir, dos nubes de puntos con los mismos puntos en diferente orden serán diferentes. Esto se soluciona más adelante.

La medida $\lambda$ del espacio $\Omega$ es su medida natural; si $\Omega$ es el continuo, $\lambda$ es la medida de Lebesgue. Es necesario trabajar en un espacio medible ya que más adelante se realizan definiciones con base en integrales.

Es necesario que la relación de orden $<$ sea compatible con la $\sigma$-álgebra $\mathcal(A)$, esto es, que los intervalos definidos a partir de $<$ sean elementos de $\mathcal(A)$. Nótese que $\Omega$ puede ser un espacio vectorial, como $\mathbb{R}^m$ de dimensión $m$, con algún orden total.




# Conceptos básicos

## Función indicatriz

Sea $\Omega$ un conjunto y $A \subseteq \Omega$ un subconjunto de $\Omega$. La función indicatriz de $A$ se define así:
\begin{gather*}
I_A: \Omega \longrightarrow \{ 0 , 1\}\\
I_A(x) := 
\begin{cases}
1 \text{ si } x \in A\\
0 \text{ si } x \notin A
\end{cases}
\end{gather*}

La función indicatriz de un subconjunto asigna 1 a los elementos del subconjunto y 0 a los elementos de su complemento.

## Función simple

Sea $f$ una función de $\Omega$ en $[0,1]$. Si existe una colección $\{A_1, ..., A_n\}$ de subconjuntos de $\Omega$ y un vector de valores no negativos $(\alpha_1, ..., \alpha_n)$ en $\mathbb{R}^{n}$ tal que $f(x) = \sum_{i=1}^n \alpha_i I_{A_i}(x)$ entonces $f$ se denomina función simple.

## $\sigma$-álgebra

Dado un conjunto arbitrario, no vacío $\Omega$, una $\sigma$-álgebra $\mathcal{A}$ sobre $\Omega$ es un conjunto de subconjuntos de $\Omega$ que cumple tres condiciones:

 - $\Omega \in \mathcal{A}$.
 - Si $A \in \mathcal{A}$ entonces su complemento $A' \in \mathcal{A}$. 
 - Si $\{A_1, A_2, ... \} \subseteq \mathcal{A}$ entonces $\bigcup_{i = 1 }^\infty A_i$ es un elemento de $\mathcal{A}$.
 
El par $(\Omega, \mathcal{A})$ se llama un {Espacio medible} y los elementos de $\mathcal{A}$ se llaman {Conjuntos medibles}.

## $\sigma$-álgebra de Borel

La menor $\sigma$-álgebra sobre $\mathbb{R}$ que contiene todos los intervalos de la forma $(-\infty, a]$ con $a \in \mathbb{R}$ se llama $\sigma$-álgebra de Borel y se denota por $\mathcal{B}$. Además, la restricción de la $\sigma$-álgebra de Borel a los reales positivos se denomina $\sigma$-álgebra de Borel en $\mathbb{R}^+$ y se denota por $\mathcal{B}^+$.

## Función medible

Sean $(\Omega, \mathcal{A})$ y $(\Omega', \mathcal{A}')$ espacios medibles. Sea una función $f: \Omega \rightarrow \Omega'$ . Entonces $f$ se llama Función medible si la preimagen de un conjunto medible es un conjunto medible. En símbolos, sea:

\begin{gather*}
f: \Omega \longrightarrow \Omega'\\
\omega \mapsto f(\omega)
\end{gather*}

$f$ es medible si

\begin{gather*}
 D \in \mathcal{A}' \text{ implica que } f^{-1}(D) \in \mathcal{A}
\end{gather*}

### Nota:

Cuando $(\Omega', \mathcal{A}')$ corresponden a $(\mathbb{R}, \mathcal{B})$, se dice que $f$ es una Función Borel-medible si la preimagen de un conjunto Borel-medible es un conjunto medible.

### Teo 1

Sea $(\Omega, \mathcal{A})$ un espacio medible.

 - Si $(f_1, ..., f_m)$ son funciones medibles y $(\alpha_1, ..., \alpha_m)$ es un vector de valores reales no negativos entonces $f(x) = \sum_{i=1}^n \alpha_i f_i(x)$ es una función medible.
 - Sea $A$ un elemento de $\mathcal{A}$, entonces la función indicatriz $I_A$ es una función medible.
 - Toda función simple de la forma $f(x) = \sum_{i=1}^n \alpha_i I_{A_i}(x)$ es medible si todos los $A_i$ pertenecen a $\mathcal{A}$ .

## Medida, espacio de medida

Sea $(\Omega, \mathcal{A})$ un espacio medible. Una {Medida} en $(\Omega, \mathcal{A})$ es una función de conjuntos $\mu: \mathcal{A} \rightarrow [0, +\infty]$ que cumple:

 - $\mu(\varnothing) = 0$
 - Si dos conjuntos $A_1, A_2 \in \mathcal{A}$ son disyuntos, entonces $\mu(A_1 \cup A_2) = \mu(A_1) + \mu(A_2)$.

La terna $(\Omega, \mathcal{A}, \mu)$ se llama {Espacio de medida}.

## Conjunto de todas las medidas

Sea $(\Omega, \mathcal{A})$ un espacio medible. El conjunto
\begin{gather*}
\mathbb{P} := \{\mu: \mathcal{A}\rightarrow [0, +\infty] \mid \mu \text{ es una medida}\}
\end{gather*}
se llama Conjunto de todas las medidas sobre $(\Omega, \mathcal{A})$.
\end{defin}

## Integral de Lebesgue

## Integral de Lebesgue para funciones indicatrices

Sea $(\Omega, \mathcal{A}, \mu)$ un espacio de medida. Sean $A$ un conjunto medible e $I_A$ su función indicatriz. La {Integral de Lebesgue} de $I_A$ con respecto a $\mu$ se define como el valor de $\mu(A)$ y se nota así:

\begin{gather*}
\int I_A d\mu := \mu(A)
\end{gather*}

## Integral de Lebesgue para funciones simples

Sea $(\Omega, \mathcal{A}, \mu)$ un espacio de medida. Sean: $\{A_i\}_{i\leq n}$ una colección conjuntos medibles disyuntos dos a dos, $\{a_i\}_{i\leq n}$ un conjunto de reales positivos y $f:=\sum_{i=1}^{n} a_i I_{A_i}$ una {función simple}. La {Integral de Lebesgue} de $f$ con respecto a $\mu$ corresponde al valor $\sum_{i=1}^{n} a_i \mu(A_i)$ y se nota así:

\begin{gather*}
\int f d\mu := \sum_{i=1}^{n} a_i \mu(A_i)
\end{gather*}



## Espacio simplex

Sea $\bigtriangleup^n \subseteq \mathbb{R}^n$ el subconjunto 

\[\bigtriangleup^n = \left \{ (a_1, ..., a_n) \in \mathbb{R}^n \mid \sum\limits_{i = 1}^n a_i = 1 \wedge \forall_{i = 1, ..., n} a_i \geq 0 \right \}\]

se denomina el espacio simplex de orden $n$.

El espacio simplex de orden $n$ está conformado por vectores cuyas entradas están entre cero y uno y suman 1. Este tipo de elementos es conocido en otros contextos con el nombre de datos composicionales, se usan para especificar la composición porcentual de un todo con respecto a sus partes.

## Distancia

Dado un conjunto $P$ una distancia es una función $d$ de $P \times P$ en $\mathbb{R}$ que cumple ciertas propiedades, para todo $a$, $b$ y $c \in P^2$:

- $d(a,b) > 0$

- $d(a,b) = 0 \longleftrightarrow a = b$

- $d(a,b) < d(a,c) + d(c,b)$


## Función (empírica)

Sea $(S, a)$ una nube de puntos de tamaño $n$. Se define su función empírica:

\begin{gather*}
f_{Em}: \Omega \longrightarrow [0,1]\\
f_{Em}(x) := \sum\limits_{i = 1}^n a_iI_{(\leftarrow x]}(s_i)
\end{gather*}

donde $(\leftarrow x]$ es el conjunto de todos los puntos en $\Omega$ menores o iguales a $x$.

### Ejemplo

La nube de puntos $S = (1, 2, 3, 5), a = (0.3, 0.2, 0.2, 0.3)$ tiene como función empírica:

```{r, echo = FALSE}

df <- data.frame(S1 = c(-1, 1, 1, 2, 2, 3, 3, 5, 5, 7), a1 = c(0, 0, 0.3, 0.3, 0.5, 0.5, 0.7, 0.7, 1, 1))

plot(df[2*(1:5) - 1,], xlim = c(-0, 6), ylim = c(-0.1, 1.1), axes = FALSE, ylab = "y", xlab = "x")
points(df[2*(1:5),], pch = 20)
lines(df[1:2,])
lines(df[3:4,])
lines(df[5:6,])
lines(df[7:8,])
lines(df[9:10,])
axis(1)
axis(2)
```

## Conjunto de todas las nubes de puntos

El conjunto de todas las posibles nubes de puntos de $\Omega$ es $\mathbb{X} = \bigcup_{i = 1}^{\infty} \Omega^n \times \bigtriangleup^n$

## Operador funcional

Dado $\Omega$ se define el operador $\mathfrak{Em}$ que asigna a cada nube de puntos $(S, a)$ su función empírica:

\begin{gather*}
\mathfrak{Em}: \mathbb{X} \longrightarrow [0,1]^{\Omega}\\
\mathfrak{Em}((S, a)) = f_{Em}
\end{gather*}

# Proposiciones, propiedades y teoremas

El operador funcional $\mathfrak{Em}$ asigna a cada nube de puntos de $\mathbb{X}$ su función empírica. Lo siguiente es investigar si este operador es inyectivo, es decir, si existen dos nubes de puntos que tengan la misma función empírica y si en esto influye el tamaño de las mismas.

## 1

El operador funcional $\mathfrak{Em}$ no es inyectivo ni sobreyectivo.

(demostrar)

## 2

En conseuencia, es posible partir el conjunto de todas las nubes de puntos. El espacio cociente resultante se denomina $O$:

\begin{gather*}
O =\mathbb{X} /\mathfrak{Em}
\end{gather*}

## Nubes de puntos equivalentes

Como consecuencia de **2** el operador $\mathfrak{Em}$ genera una partición del conjunto $\mathbb{X}$ de todas las nubes de puntos. Esta partición define una relación de equivalencia; se nota $\doteq$. En otras palabras dos nubes de puntos $(S_1, a_1)$ y $(S_2, a_2)$ son equivalentes sí y sólo sí tienen la misma función empírica.


## Estadísticas

Sea $f$ una función de $\mathbb{X}$ en un conjunto $K$. Se dice que $f$ es una estadísitica sí nubes de puntos equivalentes producen imágenes equivalentes. En símbolos:

\[(S_1, a_1) \doteq (S_2, a_2) \longrightarrow f(S_1, a_1) = f(S_2, a_2)\]

### Ejemplo

La función $\mu$ definida como sigue:

\begin{gather*}
\mu: \mathbb{X} \longrightarrow \mathbb{R}\\
\mu((S, a)) = \sum\limits_{i = 1}^n a_iS_i
\end{gather*}

donde $n$ es el tamaño de la nube de puntos $(S, a)$, se denomina **promedio** y es una estadística para las nubes de puntos con valores reales.

### Ejemplo

Por definición el operador $\mathfrak{Em}$ es una estadística.

#### Pendientes:

- Ponerle nombre a las nubes de puntos

- Ponerle nombre a la función empírica

- Ponerle nombre al operador

- Distancias entre nubes

- Suma directa de nubes
