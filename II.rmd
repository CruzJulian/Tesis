---
title: "Fundamentos"
author: "Julian Cruz"
output: 
  pdf_document:
    keep_tex: true
    toc: false
    number_sections: true
---

# Nube de puntos

## Definiciones iniciales

El objeto de estudio se denomina nube de puntos. En el argot estadístico una nube de puntos es un concepto intuitivo, que corresponde de alguna manera a una colección finita en un espacio euclidiano. Muchas veces los valores presentan una estructura de pesos muestrales o factores de expansión asociados. Estos conceptos se formalizan a continuación.

Sea $\Omega$ un espacio de Banach cualquera fijo y $\mathcal{A}$ su $\sigma$-álgebra asociada. Las siguientes son directrices de notación, acuerdos y definiciones iniciales:

 - Familia @Shao (citar, definición 2.1): Un conjunto de medidas de probabilidad sobre $(\Omega, \mathcal{A})$ se denomina familia y se nota $\mathcal{P}$. Siempre es posible indexar mediante $\mathcal{P}$ un espacio $\Theta$ que se denomina espacio de parámetros. Una familia $\mathcal{P}$ con un espacio de parámetros $\Theta$ de dimensión finita $d$, se denomina familia paramétrica. Una familia $\mathcal{P}$ cuyo espacio de parámetros $\Theta$ es neeariamente de dimensión infinita se denomina familia no paramétrica. Toda familia paremétrica está contenida en una familia no paramétrica, asímismo toda familia no paramétrica $\mathcal{P}$ contiene familias paramétricas. Toda familia se puede indexar a sí misma, en este sentido una medida de probabilidad puede ser un parámetro de si misma.

 - El conjunto de todas las medidas de probabilidad sobre $(\Omega, \mathcal{A})$ se nota $\mathbb{P}$. Dada una medida $\lambda$ sobre $(\Omega, \mathcal{A})$ se nota $\mathbb{P}_\lambda$ el conjunto de todas las medidas de probabilidad sobre $(\Omega, \mathcal{A})$ absolutamente contínuas con respecto a $\lambda$. Es posible indexar este conjunto usando el conjunto de sus derivadas con respecto a $\lambda$, no obstante se trata en general de una familia no paramétrica.
 
 - En adelante $\int$ representa la integral de Bochner. Se trata de una generalización de la integral de Lebesgue para funciones con valores en espacios de Banach. Al respecto, @COHN hace un repaso claro y conciso.^[El uso de la integral de Bochner enriquece la construcción teórica y evita el uso del concepto de vectores aleatorios.]

 - Dados dos números naturales $a$ y $b$, se nota $a:b$ al intervalo de números naturales entre $a$ y $b$ inclusive.

 - Salvo se especifique lo contrario, se usarán el símbolo $\wp$ para notar la $\sigma$-álgebra discreta en tanto el contexto sea claro.
 
 - El símbolo $\ddot{\mu}$ se reserva para la medida cardinal; y el símbolo $\ddot{\lambda}$, para la de Lebesgue.
 
 - Se nota $\mathcal{P}_n$ a la familia de todas las medidas de probabilidad sobre $(1:n, \wp)$. 
 
 - Sea $p$ un elemento de $\mathcal{P}_n$, es decir, una medida de probabilidad sobre $(1:n, \wp)$. Una función $s$ del espacio de probabilidad $(1:n,\wp, p)$ en el espacio medible, $(\Omega, \mathcal{A})$ se denomina nube de puntos.

 - Una nube de puntos $s$ es función simple. En consecuencia, @Shao, es medible. Siendo función, tiene dominio $Dom(s)$, rango $Ran(s)$, y en virtud de ser medible tiene una medida asociada $P_s$ sobre $(\Omega, \mathcal{A})$.
 
 - Dada una nube de puntos $s$ su tamaño es el máximo de su dominio: $n_s := \max(Dom(s))$.
 
 - El conjunto de todas las nubes de puntos posibles se nota por $\textbf{S}$. En otras palabras: $\textbf{S} = \{ s: (1:n, \wp, p) \rightarrow (\Omega, \mathcal{A}) \mid n \in \mathbb{N} \land p \in \textbf{P}_n\}$.
 
 - Una función medible que toma valores en un espacio de Banach se denomina variable aleatoria.^[Si bien el uso de variable aleatoria está destinado a funciones medibles de valor real, la presentación de un concepto más amplio obedece al caracter generalizado y generalizante de la construción teórica.]
 
 - Dada una variable aleatoria $X$ su valor esperado y varianza, $E$ y $Var$, están dados por: $E(X) = \int X dp$ y $Var(X) = E(X^2) - E(X)^2$. 
 
 - Se definen las funciones $\dddot{E}$ y $\dddot{Var}$, valor esperado muestral y varianza muestral: $\dddot{E}(s) = \int s dp$ y $\dddot{Var}(s) = \dddot{E}(s^2) - \dddot{E}(s)^2$. Es prudente enfatizar que el valor esperado y la varianza muestrales $\dddot{E}$ y $\dddot{Var}$ son funciones de $\textbf{S}$ en $\Omega$. El valor esperado muestral de $s$ es $\dddot{E}(s) = \sum_{i=1}^{n_s} p(\{i\})s(i)$. Que en algunos ámbitos se denomina media muestral. Asímismo, la varianza de $s$ es $Var(s) = \sum_{i=1}^{n_s} p(\{i\})(s(i) - E(s))^2$. Que en algunos ámbitos se denomina varianza poblacional.^[Evidentemente los nombres tradicionales de estas cantidades no coinciden con los aquí puestos. No se volverán a mencionar para no dar lugar a confusiones.]

De esta manera queda formalizado por completo el concepto de nubes de puntos. Los ítemes anteriores a pesar de ser triviales deben ser comprendidos a cabalidad, se sugiere un estudio detenido de los mismos para ver sus implicaciones directas. De acuerdo a la estructura propuesta, una nube de puntos $s$ tiene tamaño y probabilidades asociadas. En el uso cotidiano se suelen usar medidas de probabilidad uniformes cuya notación, $\ddot{p}$, se argumenta más adelante. Las medidas $\ddot{p}$ dan a cada punto un peso de $\frac{1}{n}$, sin embargo no son la única opción en temas de modelado.

Todo el fundamento teórico se ha escrito usando la integral de Bochner^[citar]. Al respecto es importante notar que $\Omega$ es en todo momento un espacio de Banach. Es decir, un espacio vectorial normado y completo (citar, Cálculo avanzado José francisco caicedo def 1.68). De esta forma los resultados mostrados son válidos tanto para el caso univariado como el multivariado.

## Medida de probabilidad empírica

Se define la función $\mathfrak{P}$ de $\textbf{S}$ en $\mathbb{P}$ como sigue:

\begin{align*}
\mathfrak{P}: & \textbf{S} \longrightarrow \mathbb{P}\\
& s \mapsto \mathfrak{P}(s) := P_s
\end{align*}

donde

\begin{align*}
P_s: & \mathcal{A} \longrightarrow \mathbb{R} \\
& A \mapsto P_s(A) := p(s^{-1}(A))
\end{align*}

La función $\mathfrak{P}$ asigna a cada $s \in \textbf{S}$ su medida de probabilidad asociada. Esta medida de probabilidad se denomina medida de probabilidad empírica y es el centro de discusión del presente estudio.

## Ejemplos

Dado un conjunto cualquiera $A = \{a, b, c\}$, el espacio $\Omega = \mathbb{R}^A$ es un espacio de Banach. Una nube de puntos con valores en la base canónica de $\Omega$ se denomina nube de puntos categórica.^[Profundizar]

Una medida de probabilidad $p$ sobre $(1:n, \wp)$ queda definida completamente a partir de los valores $p(\{i\})$. Así, es posible especificar una nube de puntos listando los valores de $s(i)$ y de $p(\{i\})$. Por ejemplo para $(\mathbb{R}, \mathcal{B})$ espacio de Banach medible, $s = (1, 2, 3, 5)$, $p = (0.3, 0.2, 0.2, 0.3)$ es una nube de puntos.

Sea $\Omega = \mathbb{R}\times\mathbb{R}\times\mathbb{R}\times\mathbb{R}\times \mathbb{R}^{\{ `r paste(unique(iris$Species), collapse = ", ")` \}}$ y $\mathcal{A} = \mathcal{B}\times\mathcal{B}\times\mathcal{B}\times\mathcal{B}\times\wp$. Iris^[@citar iris] es una nube de puntos de $(1:150, \wp, \dot{p})$ en $(\Omega, \mathcal{A})$.

Sea $(\Omega, \mathcal{A})$ un espacio de Banach medible cualquera fijo. Un subconjunto $A$ de $\Omega$ se dice convexo si toda nube de puntos $s$ con valores en $A$ tiene su valor esperado muestal $E(s)$ en $A$.

# Propiedades

## Restricciones

$\textbf{S}$ es un conjunto muy interesante. Es posible realizar algunas restricciones.

 - En el espacio de medida $(\mathbb{N}, \wp, \mu)$, para cada número natural $n$ existe una única medida de probabilidad $p_{\mu, n}$ generada por $\mu$ sobre $(1:n, \wp)$, es: $p_{\mu,n}(A) = \frac{\mu(A)}{\mu(1:n)}$. Así $\textbf{S} |_\mu$ es el subconjunto de $\textbf{S}$ cuyos elementos $s$ tienen como dominio $(1:n, \wp, p_{\mu,n})$ para algún $n$. Este tipo de restricción no genera una partición sobre $\textbf{S}$, pues las restricciones no son necesariamente disjuntas. En particular las restricciones finitas de $\ddot{\mu}$ se notan por $\ddot{p}$. Es evidente que $\ddot{p}$ es una medida de probabilidad uniforme.
 
 - Sea $n$ un entero positivo fijo, $\textbf{S} |_n$ es el subconjunto de $\textbf{S}$ cuyos elementos $s$ tienen tamaño $n$. Esta restricción genera una partición de $\textbf{S}$.

 - $\textbf{S} |_{\mu,n}$ es la restricción de $\textbf{S}$ cuyos elementos $s$ tienen tamaño $n$ y probabilidad $p_{\mu, n}$. Esta restricción genera una partición de $\textbf{S} |_{\mu}$

## Particiones

A continuación se muestran algunas particiones.

 - $\textbf{S}/Ran$ corresponde a la partición de $\textbf{S}$ inducida por el rango $Ran(s)$. Dos nubes de puntos $s_1$ y $s_2$ pertenecen a la misma clase si $Ran(s_1) = Ran(s_2)$.

 - $\textbf{S}/\dddot{E}$ corresponde a la partición de $\textbf{S}$ inducida por la función valor esperado muestral. Dos nubes de puntos $s_1$ y $s_2$ pertenecen a la misma clase si $\dddot{E}(s_1) = \dddot{E}(s_2)$.

 - $\textbf{S}/\dddot{Var}$ corresponde a la partición de $\textbf{S}$ inducida por la función varianza muestral. Dos nubes de puntos $s_1$ y $s_2$ pertenecen a la misma clase si $\dddot{Var}(s_1) = \dddot{Var}(s_2)$.

 - $\mathbb{S} := \textbf{S}/\mathfrak{P}$ corresponde a la partición de $\textbf{S}$ inducida por $\mathfrak{P}$. Además, se dice que dos nubes de puntos $s_1$ y $s_2$ son equivalentes si son iguales en $\mathbb{S}$ y se nota $s_1 \equiv s_2$. $\mathbb{S}$ es inmune a permutaciones. Dada una permutación $j$ tal que $s_1(i) = s_2(j)$ entonces $s_1 \equiv s_2$. Esta ultima partición implica las anteriores: Dos nubes de puntos equivalentes $s_1 \equiv s_2$ tienen el mismo rango, el mismo valor esperado y la misma varianza. Esto no se cumple para tamaño.

## Proyecciones

Dados dos números naturales $i$ y $n$, con $i \leq n$, definimos la proyección $i$-ésima sobre $\textbf{S} |_n$ así:

\begin{align}
X_i: &\textbf{S} |_n \longrightarrow \Omega\\
&s \mapsto X_i(s) := s(i)
\end{align}

Dado que la restricción $\textbf{S} |_n$ genera una partición sobre $\textbf{S}$ es posible extender $X_i$ a todo $\textbf{S}$ teniendo en cuenta que $X_i(s)$ no está definido cuando $i > n_s$.

## Subnubes

Sea $s: (1:n,\wp, p) \rightarrow (\Omega, \mathcal{A})$ una nube de puntos. Sea $n'$ menor o igual que $n$, y $t$ una función inyectiva de $1:n'$ en $1:n$, y $p'$ la probabilidad inducida, esto es: para todo $j$ en $1:n'$, $p'(\{j\}) = p(\{t(j)\})/p(t(1:n'))$. Entonces $s \circ t: (1:n',\wp, p') \rightarrow (\Omega, \mathcal{A})$ es una nube de puntos.

Dadas $s_1$ y $s_2$ nubes de puntos de $(1:n_1,\wp, p_1)$ y $(1:n_2,\wp, p_2)$ en $(\Omega, \mathcal{A})$ respectivamente, con $n_1$ menor o igual que $n_2$, si existe una función inyectiva $t$ de $1:n_1$ en $1:n_2$ tal que, para todo $j$ en $1:n_1$, $p_1(\{j\}) = p_2(\{t(j)\})/p_2(t(1:n_2))$, entonces se dice que $s_1$ es una subnube de $s_2$ y se nota $s_1 \leq s_2$

Dadas $s_1$ y $s_2$ nubes de puntos de $(1:n_1,\wp, p_1)$ y $(1:n_2,\wp, p_2)$ en $(\Omega, \mathcal{A})$ respectivamente, si $s_1 \leq s_2$ y $s_2 \leq s_1$ entonces $s_1 \equiv s_2$.

## Ecosistemas^[Esto está bien terrible]

Dada una nube de puntos $s$ sobre $(\Omega, \mathcal{A})$, el conjunto de todas las subnubes de $s$ se denomina el ecosistema generado por $s$ y se nota $\mathfrak{w}_s$. 

Sobre $\mathfrak{W}_s$ se definen las siguientes operaciones:

Un ecosistema parcial $\mathfrak{W} \subseteq \mathfrak{W}_s$ es un subconjunto propio de un ecosistema.

Dada una nube de puntos $s$ sobre $(\Omega, \mathcal{A})$ se denominaecosistema particional a todo ecosistema parcial $E$ que cumple:

Los ecosistemas particionales han sido objeto de gran estudio en estadística por propiedades muy importantes como la descomposición de la media y de la varianza.

En particular, una variable de tipo categórico $x$ puede particionar una nube de puntos en subnubes. generada por una variable categórica

## Ejemplos:

Las siguientes nubes de puntos son equivalentes en las particiones mostradas:

- $(1, 2, 2, 3) (0.3, 0.2, 0.2, 0.3)$

- $(1, 3, 2, 2) (0.3, 0.3, 0.2, 0.2)$

- $(1, 2, 3) (0.3, 0.4, 0.3)$

- $(1, 2, 3, 1) (0.2, 0.4, 0.3, 0.1)$

La nube de puntos Iris, se parte en tres subnubes, `r paste(unique(iris$Species), collapse = ", ")`. Generando un ecosistema.

# Nebulosa

## Definición (Nebulosa)

Sean los espacios de medida $(\mathbb{N}, \wp, \mu)$ y $(\Omega, \mathcal{A}, P)$. Dados $n$ en los naturales y $(\Omega^n, \mathcal{A}^n, P^n)$ el espacio de medida producto existe una biyección $I$ entre $\Omega^n$ y $\textbf{S} |_{\mu,n}$. Esto dota a $\textbf{S} |_{\mu,n}$ de una medida de probabilidad homóloga a $P^n$ generando el espacio de probabilidad $(\textbf{S} |_{\mu,n}, \mathcal{A}^n, P^n)$. Este espacio de medida se denomina una nebulosa de $(\Omega, \mathcal{A}, P)$.^[El uso de la palabra nebulosa corresponde a la imagen de una nebulosa como un conjunto de nubes, sin embargo es pertinente enfatizar que la definición incluye la estructura de medida.]

Como se ve, $(\Omega, \mathcal{A}, P)$ tiene infinitas nebulosas, dependiendo de la medida $\mu$ y del tamaño $n$. Una función medible $f$ de $(\textbf{S} |_{\mu, n}, \mathcal{A}^n, P^n)$ en $\mathbb{R}$ tiene integral $\int f dP^n$. En particular la proyeción $i$-ésima $X_i$, definida sobre $(\textbf{S} |_{\mu,n}, \mathcal{A}^n, P^n)$, es medible, por lo tanto está definida su integral.

## Lemas

Dada una función medible $f$ de $(\Omega, \mathcal{A}, P)$ en $\mathbb{R}$, a raíz de la definición de $P^n$ se tiene que:

\begin{gather}
\int f \circ X_i dP^n = \int f dP
\end{gather}

Adicionalmente, la definición propuesta de nebulosa hace posible establecer una medida sobre $\textbf{S} |_{\mu} = \bigcup\limits_{n = 1}^\infty \textbf{S} |_{\mu,n}$:

\begin{align}
P^*: &\bigcup\limits_{n=0}^\infty \mathcal{A}^n \longrightarrow \mathbb{R}\\
&S \mapsto P^*(S) = \sum\limits_{i=1}^\infty \mu(\{i\})P^n(S\cap \textbf{S} |_n) 
\end{align}

Como corolario, resulta fácil demostrar que $P^*(\textbf{S} |_{\mu,n}) = \mu(\{n\})$.

Como es de esperarse, una función medible $f$ de $(\textbf{S} |_\mu, \sigma(P^*), P^*)$ en un espacio de Banach $\mathbb{E}$ tiene integral $\int f dP^*$. Como consecuencia de los enunciados anteriores es posible representar esta integral como la suma de los valores esperados de sus restricciones de tamaño $n$, $f|_n$. Es decir, $\int f dP^* = \sum_{n=1}^\infty \mu(\{n\}) \int f|_n dP^n$.

Dada una función medible $f$ de $(\Omega, \mathcal{A}, P)$ en un espacio de Banach $\Omega'$ el valor esperado de su proyección $i$-ésima está dado por:

\begin{gather}
\int\limits_{\textbf{S} |_{\mu}} f \circ X_i dP^* = \sum\limits_{n = i}^\infty \mu(\{n\}) \int\limits_{\textbf{S} |_{\mu, n}} f \circ X_i dP^n = \mu(\mathbb{N}) \int f dP
\end{gather}

Sea el espacio de medida $(\mathbb{N}, \wp, \mu)$ y los espacios asociados $(1:n, \wp, p_{\mu, n})$, si los valores $\mu({i})$ son acotados pero $\mu(\mathbb{N})$ es infinito, entonces la sucesión $a_n = \sum_{i=1}^n \left(p_{\mu,n}(\{i\})\right)^2$ converge a cero.

Esto sucede porque $p_{\mu,n}(\{i\}) = \frac{\mu(\{i\})}{\mu(1:n)}$, de manera que si $k$ en $\mathbb{R}$ es una cota para los valores de $\mu(\{i\})$ con $i$ en $\mathbb{N}$, entonces

\begin{align}
a_n &= \sum_{i=1}^n \left(\frac{\mu(\{i\})}{\mu(1:n)}\right)^2\\
&= \frac{1}{(\mu(1:n))^2}\sum_{i=1}^n \left(\mu(\{i\})\right)^2\\
&\leq \frac{1}{(\mu(1:n))^2}\sum_{i=1}^n \mu(\{i\})\max_{j=1}^n\{\mu(\{j\})\}\\
&= \frac{1}{(\mu(1:n))^2} \max_{j=1}^n\{\mu(\{j\})\} \sum_{i=1}^n \mu(\{i\})\\
&= \frac{1}{(\mu(1:n))^2} \max_{j=1}^n\{\mu(\{j\})\} \mu(1:n)\\
&= \frac{\max_{j=1}^n\{\mu(\{j\})\}}{\mu(1:n)}\\
&\leq \frac{k}{\mu(1:n)}
\end{align}

Así que cuando $n$ aumenta $a_n$ tiende a cero.

## Teorema de valor esperado

Sean $(\textbf{S} |_{\mu,n}, \mathcal{A}^n, P^n)$ una nebulosa sobre $(\Omega, \mathcal{A}, P)$ un espacio de Banach de probabilidad cualquera fijo y la función identidad $I$ de $\Omega$ en sí mismo. La restricción de tamaño $n$ del valor esperado muestral $\dddot{E}|_n$ definido anteriormente:

\begin{align}
\dddot{E}|_n:  = &\textbf{S} |_{\mu, n} \longrightarrow \Omega\\
& s \mapsto \int s dp
\end{align}

Entonces

 - $\dddot{E}|_n$ está bien definido.
 - $\dddot{E}|_n$ es una variable aleatoria.
 - Su valor esperado, $E(\dddot{E}|_n) = \int I dP$.
 - Su varianza es $Var(\dddot{E}|_n) = Var(I)\sum_{i = 1}^n \left(p_{\mu, n}(\{i\})\right)^2$.

En efecto, $\dddot{E}|_n$ es una función de $(\textbf{S} |_{\mu,n}, \mathcal{A}^n, P^n)$ en $(\Omega, \mathcal{A}, P)$ dada por $\dddot{E}|_n = \int s dp$. Dado que todas las nubes de puntos $s$ en $(\textbf{S} |_{\mu,n}, \mathcal{A}^n, P^n)$ son funciones simples, todas resultan integrables: $\int s dp = \sum_{i=1}^n p(\{i\}) s_i$, o, usando proyecciones, $\int s dp = \sum_{i=1}^n p(\{i\}) X_i(s)$. Esto último es particularmente importante; cada proyección es variable aleatoria, en consecuencia $\dddot{E}|_n$, como suma de variables aleatorias, es variable aleatoria. Como resultado $\dddot{E}|_n$ es variable aleatoria y $(\Omega, \mathcal{A}, P)$ es une espacio de Banach, por consiguiente $\dddot{E}|_n$ tiene valor esperado $E(\dddot{E}|_n) = \int \dddot{E}|_n dP^n$. Entre las propiedades relevantes de las integrales de Riemman, de Lebesgue y de Bochner está la linealidad, en consecuencia $E(\dddot{E}|_n) = \sum_{i=1}^n p(\{i\}) \int X_i(s) dP^n$, que, factorizando y sumando, resulta igual a $\int I dP$. Así mismo la varianza de $\dddot{E}|_n$ corresponde a $Var\left(\sum_{i=1}^n p(\{i\}) X_i(s)\right)$ que es igual a $\sum_{i=1}^n (p(\{i\}))^2 Var(X_i(s))$ que a su vez es igual a $Var(I)\sum_{i = 1}^n \left(p_{\mu, n}(\{i\})\right)^2$.

A modo de corolario, el valor esperado del valor esperado muestral de una variable aleatoria coincide con su valor esperado. Es decir, dada una función medible $f: (\Omega, \mathcal{A}, P) \rightarrow \Omega'$. $\dddot{E}(f\circ s) = \sum_{i=1}^{n_s} p(\{i\})f(s(i))$ y  $E(\dddot{E}|_n \circ f) = \int f dP$. Esto se demuestra fácilmente viendo que $f\circ s$ es una nube de puntos sobre $\Omega'$, lo cual sitúa el problema en el contexto inmediatamente anterior.

Otra consecuencia del anterior teorema es que, si los valores $\mu({i})$ son acotados pero $\mu(\mathbb{N})$ es infinito, entonces la sucesión $a_n = \sum_{i=1}^n \left(p_{\mu,n}(\{i\})\right)^2$ y por ende $Var(\dddot{E})$ converge a cero. Esto se denomina ley débil de los grandes números.^[confirmar en shao]

### de Glivenko Cantelli



#### Pendientes:

- Ponerle nombre a las nubes de puntos

- Ponerle nombre a la función empírica

- Ponerle nombre al operador

- Distancias entre nubes

- Suma directa de nubes

 - Poner bonito lo que falta

 - leer

 - Arreglar lo del valor esperado.

 - GC theorme

 - Relación de orden entre nubes de puntos

 - Ejempls?

 - Completar los teoremas

 - Resolver el desorden entre $\textbf{S}$, $\textbf{S}|_\mu$ y $\textbf{S}|_{\mu, n}$.

 - Otras particiones
 
 - Los ecosistemas
 
 - Se denomina álgebra de borel a la generada por la norma en un espacio de banach.
 

